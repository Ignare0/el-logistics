name: Deploy Server

on:
  push:
    branches:
      - main  # 或者是 master，取决于你的主分支名字
    paths:
      # 关键在这里：只有以下路径下的文件变化时，才会触发部署
      - 'apps/server/**'     # 请根据你实际的后端文件夹路径修改，比如可能是 'server/**'
      - 'package.json'       # 根目录依赖变动通常也建议重新部署
      - 'pnpm-lock.yaml'     # 锁定文件变动也建议重新部署

jobs:
  trigger-render:
    runs-on: ubuntu-latest
    steps:
      - name: Call Render Deploy Hook
        run: |
          # 发送一个 POST 请求给 Render，告诉它“该干活了”
          curl -X POST "${{ secrets.RENDER_DEPLOY_HOOK }}"